<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>HW2</title>

<script src="HW2_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="HW2_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="HW2_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="HW2_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="HW2_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="HW2_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="HW2_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="HW2_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="HW2_files/navigation-1.1/tabsets.js"></script>
<link href="HW2_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="HW2_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">HW2</h1>

</div>


<div id="problem-4" class="section level1">
<h1>Problem 4</h1>
<p>From the MASS package load the Boston dataset. (Remember that the MASS package has a select command just like the tidyverse, so if you are going to use the tidyverse select command you need to load tidyverse last.)</p>
<div id="part-a" class="section level2">
<h2>Part A</h2>
<p>Start by building a model for the median household value (medv) as explained by everything else in the dataset. Save this model so you can compare the coefficients in future steps of this problem.</p>
<pre class="r"><code>model&lt;-lm(medv~.,data=Boston)
summary(model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = medv ~ ., data = Boston)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.595  -2.730  -0.518   1.777  26.199 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.646e+01  5.103e+00   7.144 3.28e-12 ***
## crim        -1.080e-01  3.286e-02  -3.287 0.001087 ** 
## zn           4.642e-02  1.373e-02   3.382 0.000778 ***
## indus        2.056e-02  6.150e-02   0.334 0.738288    
## chas         2.687e+00  8.616e-01   3.118 0.001925 ** 
## nox         -1.777e+01  3.820e+00  -4.651 4.25e-06 ***
## rm           3.810e+00  4.179e-01   9.116  &lt; 2e-16 ***
## age          6.922e-04  1.321e-02   0.052 0.958229    
## dis         -1.476e+00  1.995e-01  -7.398 6.01e-13 ***
## rad          3.060e-01  6.635e-02   4.613 5.07e-06 ***
## tax         -1.233e-02  3.760e-03  -3.280 0.001112 ** 
## ptratio     -9.527e-01  1.308e-01  -7.283 1.31e-12 ***
## black        9.312e-03  2.686e-03   3.467 0.000573 ***
## lstat       -5.248e-01  5.072e-02 -10.347  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.745 on 492 degrees of freedom
## Multiple R-squared:  0.7406, Adjusted R-squared:  0.7338 
## F-statistic: 108.1 on 13 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="part-b" class="section level2">
<h2>Part B</h2>
<p>Explicitly build the normal equations and use them to find the coefficients for the linear model. Compare to what you found in part 1. Be sure to include your code in your writeup.</p>
<pre class="r"><code>X&lt;-matrix(nrow=nrow(Boston),ncol=ncol(Boston))

y&lt;-Boston$medv
X[,1]&lt;-rep(1)
for(j in 1:13){
  X[,j+1]&lt;-Boston[,j]
}
A&lt;-t(X)%*%X
b&lt;-t(X)%*%y
beta&lt;-solve(A,b)
beta</code></pre>
<pre><code>##                [,1]
##  [1,]  3.645949e+01
##  [2,] -1.080114e-01
##  [3,]  4.642046e-02
##  [4,]  2.055863e-02
##  [5,]  2.686734e+00
##  [6,] -1.776661e+01
##  [7,]  3.809865e+00
##  [8,]  6.922246e-04
##  [9,] -1.475567e+00
## [10,]  3.060495e-01
## [11,] -1.233459e-02
## [12,] -9.527472e-01
## [13,]  9.311683e-03
## [14,] -5.247584e-01</code></pre>
<pre class="r"><code>norm(beta-model$coefficients,&quot;f&quot;)</code></pre>
<pre><code>## [1] 1.244974e-11</code></pre>
</div>
<div id="part-c" class="section level2">
<h2>Part C</h2>
<p>Find the eigenvalues of the matrix XTX and compute the ratio between the largest and the smallest eigenvalues. This ratio is called the condition number of the matrix XTX (technically the condition number is the square root of this ratio, but we don’t need the root here). The condition number in this case should be huge! What does this number mean about the matrix XTX? (Hint: think about what it means geometrically for the ratio of largest to smallest eigenvalues to be very very large)</p>
<pre class="r"><code>evalA&lt;-eigen(A)
condA&lt;-max(evalA$values)/min(evalA$values)
condA</code></pre>
<pre><code>## [1] 228418414</code></pre>
</div>
<div id="part-d" class="section level2">
<h2>Part D</h2>
<p>Now pre-process the predictors by doing a z transformation on each. Recall that <span class="math display">\[z_j=\frac{x_j-\overline{x_j}}{\sigma_{x_j}}\]</span></p>
<div id="part-i" class="section level3">
<h3>Part i</h3>
<p>Perform this pre-processing on the data and build the normal equations from this pre-processed data. What does the condition number tell you?</p>
<pre class="r"><code>Z&lt;-X
for(j in 1:13){
  #Z[,j+1]&lt;-scale(Boston[,j])
  Z[,j+1]&lt;-(X[,j+1]-mean(X[,j+1]))/sd(X[,j+1])
}
B&lt;-t(Z)%*%Z
evalB&lt;-eigen(B)
condB&lt;-max(evalB$values)/min(evalB$values)
condB</code></pre>
<pre><code>## [1] 96.47174</code></pre>
</div>
<div id="part-ii" class="section level3">
<h3>Part ii</h3>
Show that you can reverse this transformation to arrive back at the model from the non-processed data.
<span class="math display">\[\begin{align}
y &amp;= \alpha_0+\alpha_1 z_1+\cdots+\alpha_pz_p\\
&amp;=\alpha_0+\alpha_1\frac{x_1-\overline{x_1}}{\sigma_{x_1}}+\cdots+\alpha_p\frac{x_p-\overline{x_p}}{\sigma_{x_p}}\\
&amp;=\alpha_0-\sum_{i=1}^p\frac{\overline{x_i}}{\sigma_{x_i}}+\frac{\alpha_1}{\sigma_{x_1}}x_1+\cdots\frac{\alpha_p}{\sigma_{x_p}}x_p
\end{align}\]</span>
<p>Thus, letting <span class="math display">\[\beta_0=\alpha_0-\sum_{i=1}^p\frac{\overline{x_i}}{\sigma_{x_i}}\]</span> and <span class="math display">\[\beta_i=\frac{\alpha_i}{\sigma_{x_i}}\]</span> for <span class="math inline">\(i=1,\ldots,p\)</span> gets back at the model for the pre-processed model.</p>
</div>
</div>
<div id="part-e" class="section level2">
<h2>Part E</h2>
<p>The z transformation is not the only type of pre-processing that you could do. We can also pre-process our data so that every predictor has a minimum of 0 and a maximum of 1. This will force every predictor to live on the unit interval. The logic here is that we give every predictor the same range instead of the same mean and standard deviation. We’ll call this the unit transformation <span class="math display">\[u_j=\frac{x_j}{\text{max}(x_j)-\text{min}(x_j)}\]</span></p>
<div id="part-i-1" class="section level3">
<h3>Part i</h3>
<p>Perform this pre-processing on the data and build the normal equations for this pre-processed data. Again, what does the condition number tell you?</p>
<pre class="r"><code>W&lt;-X
for(j in 1:13){
  W[,j+1]&lt;-(X[,j+1])/(max(X[,j+1])-min(X[,j+1]))
}
C&lt;-t(W)%*%W
evalC&lt;-eigen(C)
condC&lt;-max(evalC$values)/min(evalC$values)
condC</code></pre>
<pre><code>## [1] 7236.003</code></pre>
</div>
<div id="part-ii-1" class="section level3">
<h3>Part ii</h3>
<p>Show that you can reverse this transformation to arrive back at the model for the non-processed data.</p>
</div>
</div>
<div id="part-f" class="section level2">
<h2>Part F</h2>
<p>At first glance it may appear that the model coefficients that you found in parts a, b, d, and e are all the same, but they are not if you look at all of the decimal places! Determine which collection of coefficients most closely matches the coefficients from R’s lm command. (be sure to do apples-to-apples comparisons)</p>
</div>
<div id="part-g" class="section level2">
<h2>Part G</h2>
<p>Summarize what we’ve done in this problem. Why is pre-processing important, and for this particular problem which type of pre-processing is the best?</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "HW2_files/mathjax-local/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
